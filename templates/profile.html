{% extends "base_app.html" %}
{% block title %}Profile{% endblock %}

{% block content %}
{% if session.user %}
<div class="profile-container">

    <!-- HEADER -->
    <div class="profile-header">
        <div class="avatar-section">
            <div class="avatar-ring">
                <img src="{{ session.get('avatar_url','/static/default-avatar.png') }}" class="avatar" id="avatarPreview">
            </div>
            <form id="avatarForm" enctype="multipart/form-data">
                <label class="upload-btn">Change Photo
                    <input type="file" name="avatar" hidden onchange="previewAvatar(event)">
                </label>
            </form>
        </div>

        <div class="profile-main">
            <h2 class="username">@{{ session['user'] }} <span class="verified">âœ”</span></h2>
            <p class="role">Creator â€¢ Member</p>
            <p class="bio-text" id="bioText">Building content, scaling brands, and using AI to grow faster ðŸš€</p>
            <div class="profile-actions">
                <button class="primary-btn" onclick="openEdit()">Edit Profile</button>
                <button class="secondary-btn">Share Profile</button>
            </div>
        </div>
    </div>

    <!-- SOCIAL LINKS -->
    <div class="social-links">
        <a href="#" class="social yt">YouTube</a>
        <a href="#" class="social ig">Instagram</a>
        <a href="#" class="social x">X</a>
        <a href="#" class="social tt">TikTok</a>
        <a href="#" class="social tw">Twitch</a>
    </div>

    <!-- STATS -->
    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-number">{{ post_count }}</span>
            <span class="stat-label">Posts</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ follower_count }}</span>
            <span class="stat-label">Followers</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ following_count }}</span>
            <span class="stat-label">Following</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">$340</span>
            <span class="stat-label">Earnings</span>
        </div>
    </div>

    <!-- CONTENT SECTIONS -->
    <div class="profile-sections">
        <div class="section-card">
            <h3>Creator Tools Used</h3>
            <ul>
                <li>YouTube AI Toolkit</li>
                <li>Instagram Caption Generator</li>
                <li>Twitch Growth Tools</li>
            </ul>
        </div>

        <div class="section-card">
            <h3>Achievements</h3>
            <div class="badges">
                <span class="badge">ðŸš€ Early Creator</span>
                <span class="badge">ðŸ”¥ 1K+ Followers</span>
                <span class="badge">ðŸ¤– AI Power User</span>
            </div>
        </div>
    </div>

</div>

<!-- EDIT PROFILE MODAL -->
<div class="modal" id="editModal">
    <div class="modal-content">
        <h3>Edit Profile</h3>
        <input type="text" placeholder="Display name">
        <textarea placeholder="Bio"></textarea>
        <input type="text" placeholder="YouTube link">
        <input type="text" placeholder="Instagram link">
        <input type="text" placeholder="X link">
        <input type="text" placeholder="TikTok link">
        <input type="text" placeholder="Twitch link">
        <div class="modal-actions">
            <button class="primary-btn" onclick="closeEdit()">Save</button>
            <button class="secondary-btn" onclick="closeEdit()">Cancel</button>
        </div>
    </div>
</div>
{% endif %}

<script>
function openEdit(){document.getElementById('editModal').classList.add('show');}
function closeEdit(){document.getElementById('editModal').classList.remove('show');}
function previewAvatar(event){document.getElementById('avatarPreview').src=URL.createObjectURL(event.target.files[0]);}
</script>

<style>
.profile-container{max-width:1100px;margin:auto;padding:40px 20px;color:white;}
.profile-header{display:flex;gap:40px;align-items:center;margin-bottom:40px;}
.avatar-ring{width:130px;height:130px;padding:4px;border-radius:50%;background:linear-gradient(135deg,#8b5cf6,#22d3ee);box-shadow:0 0 40px rgba(139,92,246,.6);}
.avatar{width:100%;height:100%;border-radius:50%;object-fit:cover;}
.upload-btn{margin-top:10px;font-size:12px;cursor:pointer;color:#22d3ee;}
.username{font-size:28px;font-weight:900;}
.verified{background:#22d3ee;color:black;padding:2px 6px;border-radius:6px;font-size:12px;}
.bio-text{color:#ccc;max-width:500px;}
.primary-btn{background:linear-gradient(90deg,#8b5cf6,#22d3ee);border:none;padding:10px 18px;border-radius:12px;color:white;font-weight:700;cursor:pointer;}
.secondary-btn{background:transparent;border:1px solid #333;padding:10px 18px;border-radius:12px;color:#ccc;cursor:pointer;}
.social-links{display:flex;gap:14px;margin-bottom:40px;}
.social{padding:10px 16px;border-radius:12px;background:#1a1a2e;border:1px solid #333;text-decoration:none;color:#fff;}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:24px;margin-bottom:40px;}
.stat-card{background:rgba(20,20,40,.8);padding:28px;border-radius:20px;text-align:center;}
.stat-number{font-size:32px;font-weight:900;background:linear-gradient(90deg,#8b5cf6,#22d3ee);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.profile-sections{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:30px;}
.section-card{background:rgba(15,15,30,.9);border-radius:20px;padding:26px;}
.badge{display:inline-block;margin:6px;padding:8px 12px;border-radius:999px;background:#222;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;}
.modal.show{display:flex;}
.modal-content{background:#0f0f1e;padding:30px;border-radius:20px;width:420px;}
.modal-content input,.modal-content textarea{width:100%;margin:10px 0;padding:12px;border-radius:10px;background:#1a1a2e;border:1px solid #333;color:white;}
.modal-actions{display:flex;justify-content:flex-end;gap:12px;margin-top:12px;}
</style>

{% endblock %}
